---
description: 根据交互式或提供的原则输入创建或更新项目章程，确保所有相关的模板保持同步。
handoffs:
   - label: 构建规格
     agent: speckit.specify
     prompt: 基于更新后的章程实施功能规格说明。我想构建...
---
## 用户输入

```text
$ARGUMENTS
```

在继续之前，您**必须**考虑用户输入（如果不为空）。

## 概述

1. **读取状态文件：**检查`conductor/setup_state.json`是否存在。
   - 如果它不存在，则这是一个新的项目设置。直接进行到步骤1.2。
   - 如果它存在，则读取其内容。
   
2. **基于状态的恢复：**
   - 将JSON文件中的`last_successful_step`的值设为`STEP`。
   - 根据`STEP`的值，跳转到**下一个逻辑部分**：


- 如果`STEP`是“2.1_product_guide”，则宣布“继续设置：产品指南（`product.md`）已完成。接下来，我们将创建产品指南。”并继续进行**第2.2节**。
- 如果`STEP`是“2.2_product_guidelines”，则宣布“继续设置：产品指南和产品指南已完成。接下来，我们将定义技术栈。”并继续执行**第2.3节**。
- 如果`STEP`是“2.3_tech_stack”，则宣布“继续设置：产品指南、准则和技术栈已定义。接下来，我们将选择代码风格指南。”并继续进行**第2.4节**。
- 如果`STEP`是“2.4_code_styleguides”，则宣布“继续设置：所有指南和技术栈均已配置。接下来，我们将定义项目工作流程。”并继续执行**第2.5节**。
- 如果`STEP`为“2.5_workflow”，则宣布“恢复设置：初始项目脚手架已完成。接下来，我们将生成第一个任务。”并继续进行**第二阶段（3.0）**。
- 如果`STEP`为“3.3_initial_track_generated”：
   - 提示：“项目已初始化。您可以使用 `/speckit:newTrack` 创建新任务，或使用 `/speckit:implement` 开始实施现有任务。”
   - 暂停`setup`进程。
- 如果`STEP`未被识别，则报错并停止。

## 1.2 预初始化概述
1. **提供高级概述：**
   - 向用户展示初始化过程的以下概览：
     “欢迎来到 Conductor。我将指导您完成以下步骤以设置您的项目：
     > 1. **项目发现**：分析当前目录，以确定这是一个新项目还是现有项目。
     > 2. **产品定义**：共同确定产品的愿景、设计准则和技术栈。
     > 3. **配置：**选择合适的代码风格指南，并定制你的开发工作流程。
     > 4. **任务生成**：定义初始的**任务**（如特性开发或bug修复等高级工作单元），并自动生成详细计划以开始开发。
     >
     “我们开始吧！”

---

## 2.0 第一阶段：简化项目设置
**协议：按照以下顺序与用户进行引导式交互设置。**


### 2.0 项目启动
1. **检测项目成熟度：**
   **项目分类**：根据以下指标确定项目是“棕地项目”（现有项目）还是“绿地项目”（新项目）：
   - **棕地指标：**
      - 检查是否存在版本控制目录：`.git`、`.svn` 或 `.hg`。
        如果存在`.git`目录，则执行`git status --porcelain`命令。如果输出内容非空，则将其归类为“棕地”（即脏仓库）。
      - 检查依赖清单：`package.json`、`pom.xml`、`requirements.txt`、`go.mod`。
      - 检查源代码目录：`src/`、`app/`、`lib/` 是否包含代码文件。
        如果满足上述任一条件（版本控制目录、未更新的git仓库、依赖清单或源代码目录），则归类为**Brownfield**。
   - **绿地条件：**
     仅当未发现任何“棕地指标”，且当前目录为空或仅包含通用文档（例如，单个`README.md`文件）且不包含功能代码或依赖项时，才可归类为**绿地**。
